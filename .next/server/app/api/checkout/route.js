"use strict";(()=>{var e={};e.id=607,e.ids=[607],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3837:e=>{e.exports=require("util")},9459:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>_,originalPathname:()=>k,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var s={};r.r(s),r.d(s,{POST:()=>p});var o=r(5419),a=r(9108),n=r(9678),i=r(8070),u=r(5256);let c=u.Ry({bookingId:u.Z_().min(1,"bookingId is required"),mode:u.Km(["deposit","full"]),amountCents:u.Rx().int().positive("amountCents must be > 0"),successUrl:u.Z_().url().optional(),cancelUrl:u.Z_().url().optional(),mockStripeError:u.O7().optional()});async function p(e){try{let t=await e.json(),s=c.safeParse(t);if(!s.success){let e=s.error.errors[0],t=e?.path?.[0]||"",r=e?.message||"Validation failed";return(e?.message==="Required"||e?.code==="invalid_type")&&t&&(r=`${t} is required`),i.Z.json({error:r},{status:400})}let{bookingId:o,mode:a,amountCents:n,successUrl:u,cancelUrl:p,mockStripeError:l}=s.data;if(l)return i.Z.json({error:"Stripe error (mocked)"},{status:400});if(!process.env.STRIPE_SECRET_KEY){let e={id:"cs_test_"+Math.random().toString(36).slice(2),url:"https://checkout.stripe.com/test_session/"+encodeURIComponent(o),mode:a,amount_total:n,success_url:u||"http://localhost:3000/success",cancel_url:p||"http://localhost:3000/cancel"};return i.Z.json({session:e},{status:200})}let d=new(await r.e(211).then(r.bind(r,1211))).default(process.env.STRIPE_SECRET_KEY,{apiVersion:"2023-10-16"}),m=await d.checkout.sessions.create({mode:"payment",payment_method_types:["card"],line_items:[{price_data:{currency:"usd",product_data:{name:`Splashtastic ${"deposit"===a?"Deposit":"Full Payment"}`},unit_amount:n},quantity:1}],metadata:{bookingId:o,mode:a},success_url:u||`${process.env.NEXT_PUBLIC_SITE_URL}/success`,cancel_url:p||`${process.env.NEXT_PUBLIC_SITE_URL}/cancel`});return i.Z.json({session:m},{status:200})}catch(t){if(t instanceof SyntaxError)return i.Z.json({error:"Invalid JSON"},{status:400});let e="string"==typeof t?.message?t.message:"Internal server error";return i.Z.json({error:e},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/checkout/route",pathname:"/api/checkout",filename:"route",bundlePath:"app/api/checkout/route"},resolvedPagePath:"C:\\Users\\Owner\\Desktop\\splash\\src\\app\\api\\checkout\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:_,staticGenerationBailout:v}=l,k="/api/checkout/route";function f(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,206,256],()=>r(9459));module.exports=s})();