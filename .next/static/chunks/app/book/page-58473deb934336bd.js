(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[886],{9205:function(e,s,a){Promise.resolve().then(a.bind(a,1049))},1049:function(e,s,a){"use strict";a.r(s),a.d(s,{BookingStepper:function(){return n}});var l=a(7437),t=a(2265);function n(e){let{initialStep:s=1,completedSteps:a=[]}=e,[n,r]=(0,t.useState)(s),[i,d]=(0,t.useState)(null),[c,o]=(0,t.useState)(null),[m,x]=(0,t.useState)(null),[u,h]=(0,t.useState)(!1),[p,b]=(0,t.useState)(!1),[j,f]=(0,t.useState)(null),[v,g]=(0,t.useState)(null),[N,y]=(0,t.useState)(null),[S,w]=(0,t.useState)([]),[k,C]=(0,t.useState)(0);(0,t.useEffect)(()=>{let e=0;N&&(e+=N.price),S.forEach(s=>{e+=s.price}),C(e)},[N,S]),(0,t.useEffect)(()=>{j&&N&&M(j)},[N]);let[P,F]=(0,t.useState)([]),[E,_]=(0,t.useState)(!1),[T,$]=(0,t.useState)({name:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",eventType:"",surface:"",notes:""}),M=async e=>{if(e)try{_(!0),d(null);let s=(null==N?void 0:N.durationMin)||120,a=await fetch("/api/availability",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,durationMin:s})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to fetch availability")}let l=(await a.json()).slots.filter(e=>e.available).map(e=>e.time);F(l),v&&!l.includes(v)&&g(null),0===l.length?d("No available time slots for this date with a ".concat(s,"-minute party. Please try a different date or consider a shorter duration.")):(o("".concat(l.length," time slots available for ").concat(e)),d(null))}catch(e){console.error("Error fetching availability:",e),d(e instanceof Error?e.message:"Unable to load availability. Please try again."),F([])}finally{_(!1)}},O=e=>{f(e),g(null),d(null),o(null),e?M(e):F([])},U=async e=>{if(!p){d("Please accept the waiver");return}d(null),console.log("Processing ".concat(e," payment"))};return(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,l.jsxs)("div",{"data-testid":"progress-indicator",className:"mb-8",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",n," of 5"]}),(0,l.jsx)("div",{className:"flex space-x-2 mt-2",children:[1,2,3,4,5].map(e=>(0,l.jsx)("button",{"data-testid":"step-".concat(e,"-button"),className:"w-8 h-8 rounded-full ".concat(e===n?"bg-blue-500 text-white":a.includes(e)?"bg-green-500 text-white":"bg-gray-200"),disabled:!a.includes(e)&&e!==n,onClick:()=>{(a.includes(e)||e===n)&&r(e)},children:e},e))})]}),1===n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Select Date & Time"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Choose your event date"}),i&&(0,l.jsx)("div",{className:"mb-4 text-red-600",role:"alert",children:i}),c&&(0,l.jsx)("div",{className:"mb-4 text-green-600",role:"alert",children:c}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium mb-2",children:"Date"}),(0,l.jsx)("input",{id:"date",type:"date",value:j||"",onChange:e=>O(e.target.value),min:new Date().toISOString().split("T")[0],className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"time",className:"block text-sm font-medium mb-2",children:"Time"}),j?E?(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,l.jsx)("span",{className:"text-sm",children:"Loading available times..."})]}):0===P.length?(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-500 text-sm mb-2",children:"No available times for this date"}),(0,l.jsx)("p",{className:"text-gray-400 text-xs",children:"Try selecting a different date"})]}):(0,l.jsxs)("select",{id:"time",value:v||"",onChange:e=>g(e.target.value),className:"border p-2 rounded w-full",children:[(0,l.jsx)("option",{value:"",children:"Select a time"}),P.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}):(0,l.jsx)("p",{className:"text-gray-500 text-sm",children:"Please select a date first"})]})]}),(0,l.jsx)("p",{children:"Please select a date"}),(0,l.jsx)("p",{children:"Please select a time"})]}),2===n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Select Package"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"Choose your foam party package"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{"data-testid":"package-starter",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat((null==N?void 0:N.name)==="Starter Party"?"border-blue-500 bg-blue-50":""),onClick:()=>{y({name:"Starter Party",price:299,durationMin:60}),d(null),o(null),j&&M(j)},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Starter Party"}),(0,l.jsx)("p",{className:"text-gray-600",children:"60 minutes • Up to 15 guests"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$299"}),(0,l.jsxs)("ul",{className:"text-sm text-gray-600 mt-2",children:[(0,l.jsx)("li",{children:"• Professional foam machine"}),(0,l.jsx)("li",{children:"• Biodegradable foam solution"}),(0,l.jsx)("li",{children:"• Setup and breakdown"})]})]}),(0,l.jsxs)("div",{"data-testid":"package-mega",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat((null==N?void 0:N.name)==="Mega Splash"?"border-blue-500 bg-blue-50":""),onClick:()=>{y({name:"Mega Splash",price:449,durationMin:90}),d(null),o(null),j&&M(j)},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Mega Splash"}),(0,l.jsx)("p",{className:"text-gray-600",children:"90 minutes • Up to 25 guests"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$449"})]}),(0,l.jsxs)("div",{"data-testid":"package-glow",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat((null==N?void 0:N.name)==="Glow Night Spectacular"?"border-blue-500 bg-blue-50":""),onClick:()=>{y({name:"Glow Night Spectacular",price:599,durationMin:90}),d(null),o(null),j&&M(j)},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Glow Night Spectacular"}),(0,l.jsx)("p",{className:"text-gray-600",children:"90 minutes • Up to 30 guests"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$599"})]})]})]}),3===n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Add-ons"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{"data-testid":"addon-extra-time",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat(S.some(e=>"Extra 30 Minutes"===e.name)?"border-green-500 bg-green-50":""),onClick:()=>{let e={name:"Extra 30 Minutes",price:99};S.some(s=>s.name===e.name)?w(S.filter(s=>s.name!==e.name)):w([...S,e])},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Extra 30 Minutes"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$99"})]}),(0,l.jsxs)("div",{"data-testid":"addon-neon-foam",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat(S.some(e=>"Neon Foam Upgrade"===e.name)?"border-green-500 bg-green-50":""),onClick:()=>{let e={name:"Neon Foam Upgrade",price:75};S.some(s=>s.name===e.name)?w(S.filter(s=>s.name!==e.name)):w([...S,e])},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Neon Foam Upgrade"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$75"})]}),(0,l.jsxs)("div",{"data-testid":"addon-slip-n-slide",className:"border p-4 rounded cursor-pointer hover:bg-gray-50 ".concat(S.some(e=>"Slip-n-Slide Combo"===e.name)?"border-green-500 bg-green-50":""),"data-available":"true",onClick:()=>{let e={name:"Slip-n-Slide Combo",price:150};S.some(s=>s.name===e.name)?w(S.filter(s=>s.name!==e.name)):w([...S,e])},children:[(0,l.jsx)("h3",{className:"font-bold",children:"Slip-n-Slide Combo"}),(0,l.jsx)("p",{className:"text-2xl font-bold",children:"$150"})]})]})]}),4===n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Event Details"}),(0,l.jsxs)("form",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium",children:"Name"}),(0,l.jsx)("input",{id:"name",type:"text",value:T.name,onChange:e=>$({...T,name:e.target.value}),className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium",children:"Email"}),(0,l.jsx)("input",{id:"email",type:"email",value:T.email,onChange:e=>$({...T,email:e.target.value}),className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium",children:"Phone"}),(0,l.jsx)("input",{id:"phone",type:"tel",value:T.phone,onChange:e=>$({...T,phone:e.target.value}),onBlur:()=>{T.phone&&(/^\+?1?\s*\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})$/.test(T.phone)?x(null):x("Please enter a valid phone number"))},className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"street",className:"block text-sm font-medium",children:"Street Address"}),(0,l.jsx)("input",{id:"street",type:"text",value:T.address,onChange:e=>$({...T,address:e.target.value}),className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium",children:"City"}),(0,l.jsx)("input",{id:"city",type:"text",value:T.city,onChange:e=>$({...T,city:e.target.value}),className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium",children:"State"}),(0,l.jsxs)("select",{id:"state",value:T.state,onChange:e=>$({...T,state:e.target.value}),className:"border p-2 rounded w-full",children:[(0,l.jsx)("option",{value:"",children:"Select State"}),(0,l.jsx)("option",{value:"MI",children:"Michigan"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"zip",className:"block text-sm font-medium",children:"Zip Code"}),(0,l.jsx)("input",{id:"zip",type:"text",value:T.zipCode,onChange:e=>$({...T,zipCode:e.target.value}),className:"border p-2 rounded w-full"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"eventType",className:"block text-sm font-medium",children:"Event Type"}),(0,l.jsx)("input",{id:"eventType",type:"text",value:T.eventType,onChange:e=>$({...T,eventType:e.target.value}),className:"border p-2 rounded w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"surface",className:"block text-sm font-medium",children:"Surface"}),(0,l.jsxs)("select",{id:"surface",value:T.surface,onChange:e=>$({...T,surface:e.target.value}),className:"border p-2 rounded w-full",children:[(0,l.jsx)("option",{value:"",children:"Select Surface"}),(0,l.jsx)("option",{value:"Grass",children:"Grass"}),(0,l.jsx)("option",{value:"Concrete",children:"Concrete"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium",children:"Notes"}),(0,l.jsx)("textarea",{id:"notes",value:T.notes,onChange:e=>$({...T,notes:e.target.value}),className:"border p-2 rounded w-full",rows:3})]})]}),u&&(0,l.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,l.jsx)("p",{children:"Name is required"}),(0,l.jsx)("p",{children:"Email is required"}),(0,l.jsx)("p",{children:"Phone is required"})]}),m&&(0,l.jsx)("p",{children:m}),(0,l.jsx)("div",{className:"mt-4 p-4 bg-green-100 rounded",children:(0,l.jsx)("p",{className:"text-green-800",children:"✓ Address is within service area"})})]}),5===n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Review & Pay"}),i&&(0,l.jsx)("div",{className:"mb-4 text-red-600",role:"alert",children:i}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Booking Summary"}),(0,l.jsxs)("div",{className:"border p-4 rounded",children:[N&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("span",{children:["Package: ",N.name]}),(0,l.jsxs)("span",{children:["$",N.price.toFixed(2)]})]}),S.length>0&&(0,l.jsx)(l.Fragment,{children:S.map((e,s)=>(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsxs)("span",{children:["+ ",e.name]}),(0,l.jsxs)("span",{children:["$",e.price.toFixed(2)]})]},s))}),(0,l.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Subtotal"}),(0,l.jsxs)("span",{children:["$",k.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Travel Fee"}),(0,l.jsx)("span",{children:"$0.00"})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Tax (8%)"}),(0,l.jsxs)("span",{children:["$",(.08*k).toFixed(2)]})]}),(0,l.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,l.jsx)("span",{children:"Total"}),(0,l.jsxs)("span",{children:["$",(1.08*k).toFixed(2)]})]})]})]})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:p,onChange:e=>b(e.target.checked)}),(0,l.jsx)("span",{children:"I accept the waiver and terms of service"})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("button",{className:"w-full bg-blue-500 text-white py-3 rounded font-bold disabled:opacity-50",disabled:!p,onClick:()=>U("deposit"),children:["Pay Deposit (30%) - $",(.3*k).toFixed(2)]}),(0,l.jsxs)("button",{className:"w-full bg-green-500 text-white py-3 rounded font-bold disabled:opacity-50",disabled:!p,onClick:()=>U("full"),children:["Pay in Full - $",(1.08*k).toFixed(2)]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h4",{children:"Card Information"}),(0,l.jsxs)("div",{className:"space-y-2 mt-2",children:[(0,l.jsx)("input",{type:"text",placeholder:"Card number",className:"border p-2 rounded w-full"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)("input",{type:"text",placeholder:"MM/YY",className:"border p-2 rounded"}),(0,l.jsx)("input",{type:"text",placeholder:"CVC",className:"border p-2 rounded"})]})]}),(0,l.jsx)("div",{className:"sr-only","aria-hidden":!0,children:"Payment failed"}),(0,l.jsx)("button",{className:"mt-3 underline text-blue-600",children:"Try again"})]})]}),(0,l.jsxs)("div",{className:"flex justify-between mt-8",children:[n>1&&(0,l.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>{n>1&&(r(n-1),d(null),x(null),h(!1))},children:"Back"}),n<5&&(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded ml-auto",onClick:()=>{if(d(null),1===n){if(!j||!v){d("Please select a date and time");return}j&&M(j),r(n+1)}if(2===n){if(!N){d("Please select a package");return}r(n+1)}if(3===n){if(!S||0===S.length){d("Please select at least one add-on");return}r(n+1)}if(4===n){if(h(!0),!T.name||!T.email||!T.phone||!T.address){d("Please fill in all required fields");return}if(!/^\+?1?\s*\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})$/.test(T.phone)){x("Please enter a valid phone number");return}x(null),r(n+1)}},children:"Next"})]})]})}},622:function(e,s,a){"use strict";var l=a(2265),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function c(e,s,a){var l,n={},c=null,o=null;for(l in void 0!==a&&(c=""+a),void 0!==s.key&&(c=""+s.key),void 0!==s.ref&&(o=s.ref),s)r.call(s,l)&&!d.hasOwnProperty(l)&&(n[l]=s[l]);if(e&&e.defaultProps)for(l in s=e.defaultProps)void 0===n[l]&&(n[l]=s[l]);return{$$typeof:t,type:e,key:c,ref:o,props:n,_owner:i.current}}s.Fragment=n,s.jsx=c,s.jsxs=c},7437:function(e,s,a){"use strict";e.exports=a(622)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=9205)}),_N_E=e.O()}]);